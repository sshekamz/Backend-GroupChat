<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link rel="stylesheet" href="./signup-login/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.26.1/axios.min.js" defer></script>
    <script>
        var name = document.getElementById('name');
        var email = document.getElementById('email');
        var phone = document.getElementById('phone');
        var password = document.getElementById('password');
        var button = document.querySelector('button');
        var form = document.querySelector('form');

function signup(e) {
    e.preventDefault();
    const obj = {
        name: name.value,
        email: email.value,
        phone: phone.value,
        password: password.value
    };
    axios.post('http://localhost:3000/admin/signup', obj)
        .then((response) => {
            console.log(response.data);
            if (response.status === 201) {
                alert('Successfully signed up');
                window.location.href='./login.html'
            }
            
        }).catch(error => {
            console.log(error);
            if (error.response.status === 403) {
                alert('email already exits');
            }
        });
}

function login(e) {
    e.preventDefault();
    const obj = {
        email: email.value,
        password: password.value
    };
    axios.post('http://localhost:3000/admin/login', obj)
        .then(response => {
            console.log(response.data);
            if (response.status === 200) {
                localStorage.setItem('token',response.data.token);
                localStorage.setItem('name',response.data.name);
                localStorage.setItem('userId',response.data.userId);
                localStorage.setItem('localMsg', '[]');
                window.location.href='./chat.html'
            } 
        }).catch(error => {
            console.log(error);
            if (error.response.status === 401) {
                alert('password do not match, login again');
                console.log('inside 401')
            }
            else if (error.response.status === 404) {
                alert('user does not exit. Please signup');
                console.log('inside 404')
            }
        })
}
    </script>
</head>
<body>
    <div class="login-box">
        <h1>Login</h1>
        <form  method="POST" onsubmit="login(event)" class="form-login">
            <label for="email">Email</label>
            <input type="email" placeholder="Enter your email" class="form-input" id="email" name="email" required>
            <label for="password">Password</label>
            <input type="password" placeholder="Enter your password" class="form-input" id="password" name="password" required>
            <button type="submit" class="signup-btn" id="signup-btn">Login</button>
        </form>
    </div>
    <p>Don't have an account? <a href="signup.html"> Sign Up</a></p>
    <script>
        const name = document.getElementById('name');
const email = document.getElementById('email');
const phone = document.getElementById('phone');
const password = document.getElementById('password');
const button = document.querySelector('button');
const form = document.querySelector('form');

function signup(e) {
    e.preventDefault();
    const obj = {
        name: name.value,
        email: email.value,
        phone: phone.value,
        password: password.value
    };
    axios.post('http://localhost:3000/admin/signup', obj)
        .then((response) => {
            console.log(response.data);
            if (response.status === 201) {
                alert('Successfully signed up');
                window.location.href='./login.html'
            }
            
        }).catch(error => {
            console.log(error);
            if (error.response.status === 403) {
                alert('email already exits');
            }
        });
}

function login(e) {
    e.preventDefault();
    const obj = {
        email: email.value,
        password: password.value
    };
    axios.post('http://localhost:3000/admin/login', obj)
        .then(response => {
            console.log(response.data);
            if (response.status === 200) {
                localStorage.setItem('token',response.data.token);
                localStorage.setItem('name',response.data.name);
                localStorage.setItem('userId',response.data.userId);
                localStorage.setItem('localMsg', '[]');
                window.location.href='./chat.html'
            } 
        }).catch(error => {
            console.log(error);
            if (error.response.status === 401) {
                alert('password do not match, login again');
                console.log('inside 401')
            }
            else if (error.response.status === 404) {
                alert('user does not exit. Please signup');
                console.log('inside 404')
            }
        })
}
    </script>
</body>
</html>